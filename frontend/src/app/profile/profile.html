<div class="profile-container">
  <div class="profile-card">
    <div class="profile-header">
      <h2>User Profile</h2>
      <div>
        <button class="back-btn" routerLink="/dashboard">Back to Dashboard</button>
        <button class="logout-btn" (click)="logout()">Logout</button>
      </div>
    </div>

    <div *ngIf="successMessage" class="success-message">
      {{ successMessage }}
    </div>

    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>

    <div *ngIf="user && !isEditing" class="profile-info">
      <div class="info-row">
        <label>Username:</label>
        <span>{{ user.username }}</span>
      </div>

      <div class="info-row">
        <label>Role:</label>
        <span class="role-badge" [class.admin]="user.role === 'ADMIN'"
              [class.incharge]="user.role === 'INCHARGE'"
              [class.member]="user.role === 'MEMBER'">
          {{ user.role }}
        </span>
      </div>

      <div class="info-row">
        <label>Contact Number:</label>
        <span>{{ user.contactNumber }}</span>
      </div>

      <div class="info-row">
        <label>Live Mode:</label>
        <span class="badge">{{ user.liveMode }}</span>
      </div>

      <div *ngIf="user.role === 'MEMBER'" class="info-message">
        Note: Members cannot edit their own profile. Please contact an Incharge or Admin to make changes.
      </div>

      <button *ngIf="user.role !== 'MEMBER'" class="edit-btn" (click)="toggleEdit()">Edit Profile</button>
    </div>

    <form *ngIf="isEditing" [formGroup]="profileForm" (ngSubmit)="onUpdateProfile()">
      <div class="form-group">
        <label>Username:</label>
        <input type="text" [value]="user?.username" disabled />
      </div>

      <div class="form-group">
        <label for="password">New Password (optional)</label>
        <input
          type="password"
          id="password"
          formControlName="password"
          placeholder="Leave blank to keep current password"
        />
      </div>

      <div class="form-group">
        <label for="contactNumber">Contact Number</label>
        <input
          type="text"
          id="contactNumber"
          formControlName="contactNumber"
          placeholder="Enter contact number"
        />
      </div>

      <div class="form-group">
        <label for="liveMode">Live Mode</label>
        <select id="liveMode" formControlName="liveMode">
          <option value="audio">Audio</option>
          <option value="video">Video</option>
        </select>
      </div>

      <div class="button-group">
        <button type="submit" [disabled]="!profileForm.valid">Save Changes</button>
        <button type="button" class="cancel-btn" (click)="toggleEdit()">Cancel</button>
      </div>
    </form>
  </div>
</div>
